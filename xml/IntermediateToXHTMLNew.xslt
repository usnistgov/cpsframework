<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" exclude-result-prefixes="xhtml xsi CPS" xmlns:CPS="http://www.TC8.org/IEC62559/UseCaseTemplate/V01" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xsi:schemaLocation="http://www.w3.org/1999/xhtml xhtml1-transitional.dtd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<xsl:output method="html" version="4.0" encoding="UTF-8" omit-xml-declaration="yes"/>
<xsl:template match="/">
<xsl:text disable-output-escaping="yes">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" &gt;</xsl:text>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="generator" content="HTML Tidy for Windows (vers 14 October 2008), see www.w3.org"/>
		<meta http-equiv="Content-Type" content="text/html; charset=us-ascii"/>
		<meta name="Generator" content="Microsoft Word 14 (filtered)"/>
		<style type="text/css">
			/*<![CDATA[*/
			<!--
			 /* Font Definitions */
			 @font-face
					{font-family:Cambria;
					panose-1:2 4 5 3 5 4 6 3 2 4;}
			@font-face
					{font-family:Tahoma;
					panose-1:2 11 6 4 3 5 4 4 2 4;}
			@font-face
					{font-family:"Arial Narrow";
					panose-1:2 11 6 6 2 2 2 3 2 4;}
			 /* Style Definitions */
			 p.MsoNormal, li.MsoNormal, div.MsoNormal
					{margin:0in;
					margin-bottom:.0001pt;
					text-align:justify;
					font-size:10.0pt;
					font-family:"Arial","sans-serif";
					letter-spacing:.4pt;}
			h1
					{mso-style-link:"Heading 1 Char";
					margin-top:24.0pt;
					margin-right:0in;
					margin-bottom:0in;
					margin-left:0in;
					margin-bottom:.0001pt;
					text-align:justify;
					page-break-after:avoid;
					font-size:14.0pt;
					font-family:"Cambria","serif";
					color:#365F91;
					letter-spacing:.4pt;}
			h2
					{mso-style-link:"Heading 2 Char";
					margin-top:10.0pt;
					margin-right:0in;
					margin-bottom:0in;
					margin-left:0in;
					margin-bottom:.0001pt;
					text-align:justify;
					page-break-after:avoid;
					font-size:13.0pt;
					font-family:"Cambria","serif";
					color:#4F81BD;
					letter-spacing:.4pt;}
			p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
					{mso-style-link:"Body Text Char";
					margin-top:0in;
					margin-right:0in;
					margin-bottom:6.0pt;
					margin-left:0in;
					text-align:justify;
					font-size:10.0pt;
					font-family:"Arial","sans-serif";
					letter-spacing:.4pt;}
			p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
					{mso-style-link:"Document Map Char";
					margin:0in;
					margin-bottom:.0001pt;
					text-align:justify;
					font-size:8.0pt;
					font-family:"Tahoma","sans-serif";
					letter-spacing:.4pt;}
			p.TableHeading, li.TableHeading, div.TableHeading
					{mso-style-name:TableHeading;
					mso-style-link:"TableHeading Char";
					margin:0in;
					margin-bottom:.0001pt;
					font-size:10.0pt;
					font-family:"Arial","sans-serif";
					color:#002060;
					letter-spacing:.4pt;
					font-weight:bold;
					font-style:italic;}
			span.TableHeadingDetail
					{mso-style-name:TableHeadingDetail;
					font-family:"Arial Narrow","sans-serif";
					color:navy;
					font-weight:normal;
					font-style:italic;}
			span.DocumentMapChar
					{mso-style-name:"Document Map Char";
					mso-style-link:"Document Map";
					font-family:"Tahoma","sans-serif";
					letter-spacing:.4pt;}
			span.Heading2Char
					{mso-style-name:"Heading 2 Char";
					mso-style-link:"Heading 2";
					font-family:"Cambria","serif";
					color:#4F81BD;
					letter-spacing:.4pt;
					font-weight:bold;}
			span.Heading1Char
					{mso-style-name:"Heading 1 Char";
					mso-style-link:"Heading 1";
					font-family:"Cambria","serif";
					color:#365F91;
					letter-spacing:.4pt;
					font-weight:bold;}
			span.BodyTextChar
					{mso-style-name:"Body Text Char";
					mso-style-link:"Body Text";
					font-family:"Arial","sans-serif";
					letter-spacing:.4pt;}
			span.TableHeadingChar
					{mso-style-name:"TableHeading Char";
					mso-style-link:TableHeading;
					font-family:"Arial","sans-serif";
					color:#002060;
					letter-spacing:.4pt;
					font-weight:bold;
					font-style:italic;}
			.MsoChpDefault
					{font-family:"Calibri","sans-serif";}
			.MsoPapDefault
					{margin-bottom:10.0pt;
					line-height:115%;}
			@page WordSection1
					{size:11.0in 8.5in;
					margin:1.0in 1.0in 1.0in 1.0in;}
			div.WordSection1
					{page:WordSection1;}
			-->
			/*]]>*/
		</style>
				<!--<title></title>-->
				<xsl:text disable-output-escaping="yes">&lt;title&gt;&lt;/title&gt;</xsl:text>
	</head>
	<body lang="EN-US" xml:lang="EN-US">
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">1       Description of the Use Case</span>
				</h1>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.1    Name of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:10.75pt">
						<td width="100%" colspan="3" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Use Case Identification</span>
							</p>
						</td>
					</tr>
					<tr style="height:10.75pt">
						<td width="7%" valign="top" style="width:7.58%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">ID</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Domain(s)</span>
							</p>
						</td>
						<td width="72%" valign="top" style="width:72.06%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:10.75pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name of Use Case</span>
							</p>
						</td>
					</tr>
					<tr style="height:11.8pt">
						<td width="7%" valign="top" style="width:7.58%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
									<xsl:value-of select="/CPSFramework/UseCase/identifier"/>
								</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
									<xsl:value-of select="/CPSFramework/BusinessCase/Domain/name"/>
									<xsl:for-each select="/CPSFramework/UseCase/AdditionalDomain">
										<xsl:text>, </xsl:text>
										<xsl:value-of select="name"/>
									</xsl:for-each>
								</span>
							</p>
						</td>
						<td width="72%" valign="top" style="width:72.06%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:11.8pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
*LOOKUP ***/CPSFramework/UseCaseLibrary/UseCase/name
*************************************************************************************
-->
									<xsl:value-of select="/CPSFramework/UseCase/name"/>
								</span>
							</p>
						</td>
					</tr>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.2    Version Management</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:1.0pt">
						<td width="100%" colspan="7" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Version Management</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="15%" valign="top" style="width:15.1%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Version Management Changes / Version</span>
							</p>
						</td>
						<td width="7%" valign="top" style="width:7.16%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Date</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10.04%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name<br/>Author(s)  or Committee</span>
							</p>
						</td>
						<td width="13%" valign="top" style="width:13.56%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Domain Expert</span>
							</p>
						</td>
						<td width="25%" valign="top" style="width:25.52%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Area of Expertise / Domain / Role</span>
							</p>
						</td>
						<td width="6%" valign="top" style="width:6.88%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Title</span>
							</p>
						</td>
						<td width="21%" valign="top" style="width:21.68%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Approval Status</span>
							</p>
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">draft, for comments, for voting, final</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
* LOOKUP ***/CPS/UseCaseLibrary/UseCase/VersionInformation
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/UseCase/Version">
						<tr>
							<td width="15%" valign="top" style="width:15.1%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="versionNumber"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="7%" valign="top" style="width:7.16%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="date"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="10%" valign="top" style="width:10.04%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="Author/name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="13%" valign="top" style="width:13.56%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="domainExpert"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="25%" valign="top" style="width:25.52%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="areaOfExpertise"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="6%" valign="top" style="width:6.88%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="title"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="21%" valign="top" style="width:21.68%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="approvalStatus"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.3    Scope and Objectives of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:17.2pt">
						<td width="100%" colspan="2" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:17.2pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Scope and Objectives of Use Case</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Related business case</span>
							</p>
						</td>
						<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP **/CPSFramework/UseCaseLibrary/UseCase/BusinessCase
*************************************************************************************
-->
									<xsl:for-each select="/CPSFramework/BusinessCase">
										<xsl:if test="position() > 1">, </xsl:if>
										<xsl:value-of select="name"/>
									</xsl:for-each>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Scope</span>
							</p>
						</td>
						<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/scope 
*************************************************************************************
-->
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/BusinessCase/description"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="24%" valign="top" style="width:24.14%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Objective</span>
							</p>
						</td>
						<td width="75%" valign="top" style="width:75.86%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/RelatedObjective
*************************************************************************************
-->
									<xsl:for-each select="/CPSFramework/BusinessCase/RelatedObjective">
										<xsl:if test="position() > 1">, </xsl:if>
										<xsl:value-of select="name"/>
									</xsl:for-each>
								</span>
							</p>
						</td>
					</tr>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.4    Narrative of Use Case</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Narrative of Use Case</span>
							</p>
						</td>
					</tr>
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Short description - max 3 sentences</span>
							</p>
						</td>
					</tr>
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/Narrative/shortDescription
*************************************************************************************
-->
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/Narrative/shortDescription"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Complete description</span>
							</p>
						</td>
					</tr>
					<tr style="height:1.0pt">
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt;height:1.0pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/Narrative/completeDescription
*************************************************************************************
-->
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/Narrative/completeDescription"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">1.5    General Remarks</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">General Remarks</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/GeneralRemark
*************************************************************************************
-->
									<xsl:for-each select="/CPSFramework/UseCaseLibrary/UseCase/Remark">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="content"/>
										</xsl:call-template>
									</xsl:for-each>
								</span>
							</p>
						</td>
					</tr>
				</table>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">2       Diagrams of Use Case</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#BFBFBF;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Diagram of Use Case</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/Diagram
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/UseCaseLibrary/UseCase/Diagram">
						<tr>
							<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:element name="img">
											<!--											<xsl:attribute name="border">0</xsl:attribute>-->
											<xsl:attribute name="width"><xsl:value-of select="substring-before(substring-after(URI,'W'),'_')"/></xsl:attribute>
											<xsl:attribute name="height"><xsl:value-of select="substring-before(substring-after(URI,'H'),'_')"/></xsl:attribute>
											<xsl:attribute name="src"><xsl:value-of select="URI"/></xsl:attribute>
											<xsl:attribute name="alt"/>
											<!--<img border="0" width="387" height="109" src="IEC_UseCaseTemplateGOOD_files/image014.png" alt="" />-->
										</xsl:element>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">3       Technical Details</span>
				</h1>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.1    Actors: People, Systems, Applications, Databases, the Power System, and Other Stakeholders</span>
				</h2>
				<!--
*************************************************************************************
* LOOKUP /CPSFramework/DomainLibrary/Domain
*************************************************************************************
-->
				<xsl:for-each select="/CPSFramework/UseCase/CPSGrouping">
					<xsl:variable name="DomainName" select="name"/>
					<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
						<tr>
							<td width="100%" colspan="4" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Actors</span>
								</p>
							</td>
						</tr>
						<tr>
							<td width="42%" colspan="2" valign="top" style="width:42.98%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Grouping (Community)</span>
								</p>
							</td>
							<td width="57%" colspan="2" valign="top" style="width:57.02%;border-top:none; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Group Description</span>
								</p>
							</td>
						</tr>
						<tr>
							<td width="42%" colspan="2" valign="top" style="width:42.98%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="$DomainName"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="57%" colspan="2" valign="top" style="width:57.02%;border-top:none; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="description"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
						<tr>
							<td width="22%" valign="top" style="width:22.26%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Actor Name</span>
								</p>
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">see Actor  List</span>
								</p>
							</td>
							<td width="20%" valign="top" style="width:20.72%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Actor Type</span>
								</p>
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">see Actor  List</span>
								</p>
							</td>
							<td width="35%" valign="top" style="width:35.32%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Actor Description</span>
								</p>
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">see Actor  List</span>
								</p>
							</td>
							<td width="21%" valign="top" style="width:21.7%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Further information specific to this Use Case</span>
								</p>
							</td>
						</tr>
						<xsl:for-each select="/CPSFramework/UseCase/CPSGrouping[name=$DomainName]">
							<xsl:for-each select="CPS">
								<tr>
									<td width="22%" valign="top" style="width:22.26%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
										<p class="MsoNormal">
											<span lang="EN-GB" xml:lang="EN-GB">
												<xsl:call-template name="OutputCellContent">
													<xsl:with-param name="Value" select="name"/>
												</xsl:call-template>
											</span>
										</p>
									</td>
									<td width="20%" valign="top" style="width:20.72%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
										<p class="MsoNormal">
											<span lang="EN-GB" xml:lang="EN-GB">
												<xsl:call-template name="OutputCellContent">
													<xsl:with-param name="Value" select="technicalId"/>
												</xsl:call-template>
											</span>
										</p>
									</td>
									<td width="35%" valign="top" style="width:35.32%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
										<p class="MsoNormal">
											<span lang="EN-GB" xml:lang="EN-GB">
												<xsl:call-template name="OutputCellContent">
													<xsl:with-param name="Value" select="description"/>
												</xsl:call-template>
											</span>
										</p>
									</td>
									<td width="21%" valign="top" style="width:21.7%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
										<p class="MsoNormal">
											<span lang="EN-GB" xml:lang="EN-GB">
												<xsl:call-template name="OutputCellContent">
													<xsl:with-param name="Value" select="furtherInformation"/>
												</xsl:call-template>
											</span>
										</p>
									</td>
								</tr>
							</xsl:for-each>
						</xsl:for-each>
					</table>
				</xsl:for-each>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.2    Preconditions, Assumptions, Post condition, Events</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="4" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Use Case Conditions</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="32%" valign="top" style="width:32.8%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Actor/System/Information/Contract</span>
							</p>
						</td>
						<td width="17%" valign="top" style="width:17.8%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Triggering Event</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15.94%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Pre-conditions</span>
							</p>
						</td>
						<td width="33%" valign="top" style="width:33.46%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Assumption</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/Condition
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/UseCase">
						<tr>
							<td width="32%" style="width:32.8%;border:solid windowtext 1.0pt;border-top: none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="Prerequisite/name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="17%" valign="top" style="width:17.8%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="trigerringEvent"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="15%" valign="top" style="width:15.94%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:for-each select="PreCondition">
											<xsl:if test="position()>1">, </xsl:if>
											<xsl:value-of select="content"/>
										</xsl:for-each>
									</span>
								</p>
							</td>
							<td width="33%" valign="top" style="width:33.46%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="Assumption/name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.3    References / Issues</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="7" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">References</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="5%" valign="top" style="width:5.3%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">No.</span>
							</p>
						</td>
						<td width="17%" valign="top" style="width:17.56%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">References Type</span>
							</p>
						</td>
						<td width="16%" valign="top" style="width:16.64%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Reference</span>
							</p>
						</td>
						<td width="10%" valign="top" style="width:10.26%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Status</span>
							</p>
						</td>
						<td width="16%" valign="top" style="width:16.68%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Impact on Use Case</span>
							</p>
						</td>
						<td width="17%" valign="top" style="width:17.98%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Originator / Organisation</span>
							</p>
						</td>
						<td width="15%" valign="top" style="width:15.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Link</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
* LOOKUP ****/CPSFramework/UseCaseLibrary/UseCase/Reference
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/UseCase/Reference">
						<tr>
							<td width="5%" valign="top" style="width:5.3%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="identifier"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="17%" valign="top" style="width:17.56%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="type"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="16%" valign="top" style="width:16.64%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="10%" valign="top" style="width:10.26%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="status"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="16%" valign="top" style="width:16.68%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="impact"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="17%" valign="top" style="width:17.98%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="originatorOrganisation"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="15%" valign="top" style="width:15.36%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="link"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<h2>
					<span lang="EN-GB" xml:lang="EN-GB">3.4    Further Information to the Use Case for Classification / Mapping</span>
				</h2>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Classification Information</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Relation to Other Use Cases</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--
*************************************************************************************
* LOOKUP /CPSFramework/UseCaseLibrary/UseCase/UseCaseRelation
*************************************************************************************
-->
									<xsl:for-each select="/CPSFramework/UseCase/RelatedUseCase">
										
											<xsl:if test="position() > 1">,</xsl:if>
											<xsl:value-of select="name"/>
										
									</xsl:for-each>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Level of Depth</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/levelOfDepth"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Prioritisation</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/prioritisation"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Generic, Regional or National Relation</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/classification"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">View</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/nature"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Further Keywords  for Classification</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="100%" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<xsl:call-template name="OutputCellContent">
										<xsl:with-param name="Value" select="/CPSFramework/UseCase/keywords"/>
									</xsl:call-template>
								</span>
							</p>
						</td>
					</tr>
				</table>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">4       Step by Step Analysis of Use Case</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr style="height:14.35pt">
						<td width="100%" colspan="6" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt;height:14.35pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Scenario Conditions</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="6%" valign="top" style="width:6.04%;border:solid windowtext 1.0pt; border-top:none;background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">No.</span>
							</p>
						</td>
						<td width="16%" valign="top" style="width:16.82%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Scenario Name</span>
							</p>
						</td>
						<td width="19%" valign="top" style="width:19.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Primary Actor</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Triggering Event</span>
							</p>
						</td>
						<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Pre-Condition</span>
							</p>
						</td>
						<td width="16%" valign="top" style="width:16.34%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#D9D9D9;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Post-Condition</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/UseCase/Scenario">
						<tr>
							<td width="6%" valign="top" style="width:6.04%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="number"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="16%" valign="top" style="width:16.82%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="19%" valign="top" style="width:19.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="PrimaryCPS/name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="TriggeringEvent"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="20%" valign="top" style="width:20.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="Precondition"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="16%" valign="top" style="width:16.34%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="Postcondition"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<!--
******************************************************************************************************
Table	Steps Section
******************************************************************************************************
-->
				<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
				<xsl:for-each select="/CPSFramework/UseCase/Scenario">
					<h2>
						<span lang="EN-GB" xml:lang="EN-GB">
							<xsl:value-of select="number"/>   Steps - <xsl:value-of select="name"/>
						</span>
					</h2>
					<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse">
						<tr>
							<td width="100%" colspan="9" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Scenario</span>
								</p>
							</td>
						</tr>
						<tr>
							<td width="13%" colspan="2" valign="top" style="width:13.92%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Scenario Name :</span>
								</p>
							</td>
							<td width="86%" colspan="7" valign="top" style="width:86.08%;border-top:none; border-left:none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
						</tr>
						<tr style="height:12.55pt">
							<td width="6%" valign="top" style="width:6.48%;border-top:none;border-left: solid windowtext 1.0pt;border-bottom:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Step No.</span>
								</p>
							</td>
							<td width="7%" valign="top" style="width:7.44%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Event</span>
								</p>
							</td>
							<td width="12%" valign="top" style="width:12.1%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Name of Process/ Activity</span>
								</p>
							</td>
							<td width="13%" valign="top" style="width:13.38%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Description of Process/ Activity</span>
								</p>
							</td>
							<td width="9%" valign="top" style="width:9.82%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Service</span>
								</p>
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB"> </span>
								</p>
							</td>
							<td width="12%" valign="top" style="width:12.32%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Information Producer (Actor)</span>
								</p>
							</td>
							<td width="12%" valign="top" style="width:12.66%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Information Receiver (Actor)</span>
								</p>
							</td>
							<td width="13%" valign="top" style="width:13.34%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Information Exchanged</span>
								</p>
							</td>
							<td width="12%" valign="top" style="width:12.5%;border:none;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt;height:12.55pt">
								<p class="TableHeading">
									<span lang="EN-GB" xml:lang="EN-GB">Requirements , R-ID</span>
								</p>
							</td>
						</tr>
						<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
                   
						<xsl:for-each select="MacroActivity/Step">
							<tr style="height:9.2pt">
								<td width="6%" valign="top" style="width:6.48%;border:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="identifier"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="7%" valign="top" style="width:7.44%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="event"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="12%" valign="top" style="width:12.1%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="name"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="13%" valign="top" style="width:13.38%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="description"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="9%" valign="top" style="width:9.82%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="service"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="12%" valign="top" style="width:12.32%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="InformationProducer/name"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="12%" valign="top" style="width:12.66%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="InformationReceiver/name"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="13%" valign="top" style="width:13.34%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:call-template name="OutputCellContent">
												<xsl:with-param name="Value" select="BusinessObject/name"/>
											</xsl:call-template>
										</span>
									</p>
								</td>
								<td width="12%" valign="top" style="width:12.5%;border:solid windowtext 1.0pt; border-left:none;padding:0in 5.4pt 0in 5.4pt;height:9.2pt">
									<p class="MsoNormal">
										<span lang="EN-GB" xml:lang="EN-GB">
											<xsl:variable name="ReqtsA">
												<xsl:for-each select="Requirement">
													<xsl:call-template name="OutputCellContent">
														<xsl:with-param name="Value" select="id"/>
													</xsl:call-template>
													<xsl:if test="position() &lt; count(../Requirement)">
														<xsl:text>,</xsl:text>
													</xsl:if>
												</xsl:for-each>
											</xsl:variable>
											<xsl:value-of select="$ReqtsA"/>
										</span>
									</p>
								</td>
							</tr>
							</xsl:for-each>
						
						
					</table>
				</xsl:for-each>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">5       Information Exchanged</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="3" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Information Exchanged</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="19%" valign="top" style="width:19.74%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Name of Information Exchanged</span>
							</p>
						</td>
						<td width="44%" valign="top" style="width:44.66%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Description of Information Exchanged</span>
							</p>
						</td>
						<td width="35%" valign="top" style="width:35.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Requirements to information data</span>
							</p>
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">R-ID</span>
							</p>
						</td>
					</tr>
					<!--
*************************************************************************************
********************************** LOOKUP ***************************************
*************************************************************************************
-->
					<xsl:for-each select="/CPSFramework/InformationModelLibrary/InformationModel">
						<tr>
							<td width="19%" valign="top" style="width:19.74%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="name"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="44%" valign="top" style="width:44.66%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:call-template name="OutputCellContent">
											<xsl:with-param name="Value" select="description"/>
										</xsl:call-template>
									</span>
								</p>
							</td>
							<td width="35%" valign="top" style="width:35.6%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
								<p class="MsoNormal">
									<span lang="EN-GB" xml:lang="EN-GB">
										<xsl:variable name="ReqtsA">
											<xsl:for-each select="referencedRequirement">
												<xsl:call-template name="OutputCellContent">
													<xsl:with-param name="Value" select="id"/>
												</xsl:call-template>
												<xsl:if test="position() &lt; count(../referencedRequirement)">
													<xsl:text>,</xsl:text>
												</xsl:if>
											</xsl:for-each>
										</xsl:variable>
										<xsl:value-of select="$ReqtsA"/>
									</span>
								</p>
							</td>
						</tr>
					</xsl:for-each>
				</table>
				<h1>
					<span lang="EN-GB" xml:lang="EN-GB">6       Common Terms and Definitions</span>
				</h1>
				<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;border-collapse:collapse;border:none">
					<tr>
						<td width="100%" colspan="2" valign="top" style="width:100.0%;border:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Common Terms and Definitions</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="29%" valign="top" style="width:29.22%;border:solid windowtext 1.0pt; border-top:none;background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Term</span>
							</p>
						</td>
						<td width="70%" valign="top" style="width:70.78%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; background:#CCCCCC;padding:0in 5.4pt 0in 5.4pt">
							<p class="TableHeading">
								<span lang="EN-GB" xml:lang="EN-GB">Definition</span>
							</p>
						</td>
					</tr>
					<tr>
						<td width="29%" valign="top" style="width:29.22%;border:solid windowtext 1.0pt; border-top:none;padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--U_Term-->
								</span>
							</p>
						</td>
						<td width="70%" valign="top" style="width:70.78%;border-top:none;border-left: none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt; padding:0in 5.4pt 0in 5.4pt">
							<p class="MsoNormal">
								<span lang="EN-GB" xml:lang="EN-GB">
									<!--U_Definition-->
								</span>
							</p>
						</td>
					</tr>
				</table>
				<p class="MsoNormal">
					<span lang="EN-GB" xml:lang="EN-GB"> </span>
				</p>
			</body>
		</html>
	</xsl:template>
	<xsl:template name="OutputCellContent">
		<xsl:param name="Value"/>
		<p class="MsoNormal">
			<!--			<span lang="EN-GB" xml:lang="EN-GB">-->
			<xsl:variable name="NewValue1">
				<xsl:call-template name="CheckForImages">
					<xsl:with-param name="Value" select="$Value"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:variable name="NewValue2">
				<xsl:call-template name="CheckForDoubleCRLF">
					<xsl:with-param name="Value" select="$NewValue1"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:variable name="NewValue3">
				<xsl:call-template name="CheckForCRLF">
					<xsl:with-param name="Value" select="$NewValue2"/>
				</xsl:call-template>
			</xsl:variable>
			<xsl:value-of disable-output-escaping="yes" select="$NewValue3"/>
			<!--			</span>-->
		</p>
	</xsl:template>
	<xsl:template name="CheckForImages">
		<xsl:param name="Value"/>
		<xsl:choose>
			<xsl:when test="contains($Value,'&amp;lt;img')">
				<xsl:variable name="ImageDetails" select="substring-before(substring-after($Value,'&amp;lt;img '),'&amp;gt;')"/>
				<xsl:variable name="ImageSrc" select="substring-before(substring-after($ImageDetails,'src=&quot;'),'&quot;')"/>
				<xsl:variable name="ImageWidth" select="substring-before(substring-after($ImageDetails,'width=&quot;'),'&quot;')"/>
				<xsl:variable name="ImageHeight" select="substring-before(substring-after($ImageDetails,'height=&quot;'),'&quot;')"/>
				<xsl:variable name="ImageId" select="substring-before(substring-after($ImageDetails,'id=&quot;'),'&quot;')"/>
				<xsl:variable name="ImageAlign" select="substring-before(substring-after($ImageDetails,'align=&quot;'),'&quot;')"/>
				<xsl:variable name="ImageStyle" select="substring-before(substring-after($ImageDetails,'style=&quot;'),'&quot;')"/>
				<xsl:variable name="FullImageInfo">
					<xsl:text>&amp;lt;img </xsl:text>
					<xsl:value-of select="$ImageDetails"/>
					<xsl:text>&amp;gt;</xsl:text>
				</xsl:variable>
				<xsl:variable name="ImageReplaceStringA">
					<xsl:element name="p">
						<xsl:attribute name="class">MsoNormal</xsl:attribute>
						<xsl:if test="$ImageAlign != ''">
							<xsl:attribute name="align"><xsl:value-of select="$ImageAlign"/></xsl:attribute>
						</xsl:if>
						<xsl:if test="$ImageStyle != ''">
							<xsl:attribute name="style"><xsl:value-of select="$ImageStyle"/></xsl:attribute>
						</xsl:if>
						<xsl:element name="img">
							<xsl:attribute name="width"><xsl:value-of select="$ImageWidth"/></xsl:attribute>
							<xsl:attribute name="height"><xsl:value-of select="$ImageHeight"/></xsl:attribute>
							<xsl:attribute name="id"><xsl:value-of select="$ImageId"/></xsl:attribute>
							<xsl:attribute name="src"><xsl:value-of select="$ImageSrc"/></xsl:attribute>
							<xsl:attribute name="alt">Description: <xsl:value-of select="$ImageSrc"/></xsl:attribute>
							<xsl:attribute name="name"><xsl:value-of select="$ImageId"/></xsl:attribute>
						</xsl:element>
					</xsl:element>
				</xsl:variable>
				<xsl:variable name="ImageReplaceString">
					<xsl:apply-templates select="msxsl:node-set($ImageReplaceStringA)" mode="serialize"/>
					<!-- for msxml -->
					<!--<xsl:apply-templates select="$ImageReplaceStringA" mode="serialize"/>-->
					<!-- for altova -->
				</xsl:variable>
				<xsl:variable name="NewString">
					<xsl:call-template name="string-replace-all">
						<xsl:with-param name="text" select="$Value"/>
						<xsl:with-param name="replace" select="$FullImageInfo"/>
						<xsl:with-param name="by" select="$ImageReplaceString"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:call-template name="CheckForImages">
					<xsl:with-param name="Value" select="$NewString"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$Value"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template match="*" mode="serialize">
		<xsl:text>&lt;</xsl:text>
		<xsl:value-of select="name()"/>
		<xsl:apply-templates mode="serialize" select="@*"/>
		<xsl:text>&gt;</xsl:text>
		<xsl:apply-templates mode="serialize"/>
		<xsl:text>&lt;/</xsl:text>
		<xsl:value-of select="name()"/>
		<xsl:text>&gt;</xsl:text>
	</xsl:template>
	<xsl:template match="@*" mode="serialize">
		<xsl:text> </xsl:text>
		<xsl:value-of select="name()"/>
		<xsl:text>="</xsl:text>
		<xsl:value-of select="."/>
		<xsl:text>"</xsl:text>
	</xsl:template>
	<xsl:template match="text()" mode="serialize">
		<xsl:value-of select="."/>
	</xsl:template>
	<xsl:template name="CheckForCRLF">
		<xsl:param name="Value"/>
		<xsl:choose>
			<xsl:when test="contains($Value,'&amp;#13;&amp;#10;')">
				<xsl:variable name="ReplaceString">
					<xsl:text>&lt;/p&gt;&lt;p class="MsoNormal"&gt;</xsl:text>
				</xsl:variable>
				<xsl:variable name="NewString">
					<xsl:call-template name="string-replace-all">
						<xsl:with-param name="text" select="$Value"/>
						<xsl:with-param name="replace" select="'&amp;#13;&amp;#10;'"/>
						<xsl:with-param name="by" select="$ReplaceString"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:call-template name="CheckForCRLF">
					<xsl:with-param name="Value" select="$NewString"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$Value"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="CheckForDoubleCRLF">
		<xsl:param name="Value"/>
		<xsl:choose>
			<xsl:when test="contains($Value,'&amp;#13;&amp;#10;&amp;#13;&amp;#10;')">
				<xsl:variable name="ReplaceString">
					<xsl:text disable-output-escaping="yes">&lt;/p&gt;&lt;p class="MsoNormal"&gt;<![CDATA[&nbsp;]]>&lt;/p&gt;&lt;p class="MsoNormal"&gt;</xsl:text>
				</xsl:variable>
				<xsl:variable name="NewString">
					<xsl:call-template name="string-replace-all">
						<xsl:with-param name="text" select="$Value"/>
						<xsl:with-param name="replace" select="'&amp;#13;&amp;#10;&amp;#13;&amp;#10;'"/>
						<xsl:with-param name="by" select="$ReplaceString"/>
					</xsl:call-template>
				</xsl:variable>
				<xsl:call-template name="CheckForDoubleCRLF">
					<xsl:with-param name="Value" select="$NewString"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$Value"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="string-replace-all">
		<xsl:param name="text"/>
		<xsl:param name="replace"/>
		<xsl:param name="by"/>
		<xsl:choose>
			<xsl:when test="contains($text, $replace)">
				<xsl:value-of select="substring-before($text,$replace)"/>
				<xsl:value-of select="$by"/>
				<xsl:call-template name="string-replace-all">
					<xsl:with-param name="text" select="substring-after($text,$replace)"/>
					<xsl:with-param name="replace" select="$replace"/>
					<xsl:with-param name="by" select="$by"/>
				</xsl:call-template>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="$text"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet>
